---
layout: post
title: Get Physical Path From Metadata Libref
date: '2015-03-17T06:16:00.004-07:00'
author: Allan Bowe
tags: 
modified_time: '2015-06-08T13:28:33.200-07:00'
blogger_id: tag:blogger.com,1999:blog-3488921339026456633.post-4762711918910583584
blogger_orig_url: http://www.rawsas.com/2015/03/get-physical-path-from-metadata-libref.html
---

So it turns out that it is not possible to place a SAS lock on a table referenced via the Metadata Libname Engine:<br /><br /><span style="font-family: Courier New, Courier, monospace;">WARNING: LOCK is not supported in MLE.</span><br /><br />To circumvent this issue, one approach is to assign a libref directly. The following macro takes a libref (placed in the lib= keyword parameter) and queries the metadata for a physical path (placed in macro variable specified in the outvar= keyword parameter).<br /><br />Note that not all librefs have an underlying directory (eg database tables).<br /><br /><span style="font-family: Courier New, Courier, monospace;">%macro get_path_from_metalibref(lib=,outvar=filepath);</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp;data _null_;</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; putlog "NOTE: Getting physical path for &amp;lib library";</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; length lib_uri up_uri filepath $256;</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; call missing (of _all_);</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; /* get URI for the particular library */</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; rc1=metadata_getnobj("omsobj:SASLibrary?@Libref ='&amp;lib'",1,lib_uri);</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; put rc1= lib_uri= ;</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; /* get first object of the UsingPackages association (assumed to be Path) */</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; rc2=metadata_getnasn(lib_uri,'UsingPackages',1,up_uri);</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; put rc2= up_uri= ;</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; /* get the DirectoryName attribute of the previous object */</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; rc3=metadata_getattr(up_uri,'DirectoryName',filepath);</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; put rc3= filepath=;</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; &nbsp; call symputx("&amp;outvar",filepath,'g');</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp;run;</span><br /><span style="font-family: Courier New, Courier, monospace;">%mend;</span><div class="changetip_tipme_button" data-bid="11a492c4-afd5-4c83-9bcc-d304573e1386" data-uid="5ea266567da74e6b814193ba026edff3"></div><script>(function(document,script,id){var js,r=document.getElementsByTagName(script)[0],protocol=/^http:/.test(document.location)?'http':'https';if(!document.getElementById(id)){js=document.createElement(script);js.id=id;js.src=protocol+'://widgets.changetip.com/public/js/widgets.js';r.parentNode.insertBefore(js,r)}}(document,'script','changetip_w_0'));</script>