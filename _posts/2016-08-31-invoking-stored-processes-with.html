---
layout: post
title: Invoking Stored Processes with Powershell - the easy way
date: '2016-08-31T10:16:00.001-07:00'
author: Allan Bowe
tags:
modified_time: '2016-08-31T13:33:10.374-07:00'
thumbnail: /assets/images/Capture.PNG
blogger_id: tag:blogger.com,1999:blog-3488921339026456633.post-5107642406987455535
blogger_orig_url: http://www.rawsas.com/2016/08/invoking-stored-processes-with.html
---

There are a number of ways to run SAS from Powershell:<br /><ol><li>Using SAS Integration Technologies (Chris Hemedinger has some great <a href="http://blogs.sas.com/content/sasdummy/tag/powershell/" target="_blank">resources</a> on this)</li><li>Directly by calling sas.exe (presuming you are running on a box with a local install)</li><li>Indirectly via the SAS Stored Process Web Application.</li></ol><div>Let me explain the awesomeness of option 3:</div><div><ul><li>It deals with authentication (no need for embedded passwords)</li><li>Can perform tasks using system account (sassrv), as SAS code is secured server-side</li><li>Resource management (no need to tidy up any redundant sessions)</li><li>Can be done in just&nbsp;<b>ONE LINE</b> of Powershell code!</li></ul></div><div>For the sake of mobile readers, I'm going to split the example over three lines:</div><blockquote class="tr_bq"><div class="MsoNormal" style="background: white; margin-bottom: 0.0001pt;"><span style="color: orangered; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">$uri</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;">=</span><span style="color: darkred; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">"http://YOURSERVER.YOURDOMAIN:8080/SASStoredProcess/do"</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><o:p></o:p></span></div><div class="MsoNormal" style="background: white; margin-bottom: 0.0001pt;"><span style="color: orangered; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">$pgm</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;">=</span><span style="color: darkred; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">"/Products/SAS Intelligence Platform/Samples/Sample: Hello World"</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"><o:p></o:p></span></div><div class="MsoNormal" style="background: white; margin-bottom: 0.0001pt;"><span style="color: blue; font-family: &quot;lucida console&quot;; font-size: 9.0pt;">invoke-webrequest</span><span style="font-family: &quot;lucida console&quot;; font-size: 9.0pt;"> <span style="color: navy;">-Uri</span> <span style="color: darkred;">"</span>$(<span style="color: orangered;">$uri</span>)<span style="color: darkred;">?_program=</span><span style="color: orangered;">$pgm</span><span style="color: darkred;">"</span> <span style="color: navy;">-UseDefaultCredentials</span></span></div></blockquote>Which gives the response:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="/assets/images/Capture.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="278" src="/assets/images/Capture.PNG" width="400" /></a></div><br />The key part to this request, to avoid HTTP Status 401 and "This request requires HTTP authentication" response, is the&nbsp;<span style="background-color: white; color: navy; font-family: &quot;lucida console&quot;; font-size: 12px;">-UseDefaultCredentials&nbsp;</span>parameter. &nbsp;This uses the account that Powershell is running in, to connect to the server.<br /><br />Some prerequisites:<br /><ul><li>You need to configure your SAS code to run inside a Stored Process using SAS Management Console - set for streaming output&nbsp;</li><li>You may need to set your execution policy (explained <a href="http://blogs.sas.com/content/sasdummy/2011/09/12/running-windows-powershell-scripts/" target="_blank">here</a>)</li><li>The account being used to run the script must have a SAS identity, and the web server must be configured for single signon.</li></ul><br /><blockquote class="tr_bq"><div class="MsoNormal" style="background: white; margin-bottom: 0.0001pt;"><br /></div></blockquote>
