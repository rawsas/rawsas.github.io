---
layout: post
title: Finding MIN (or even MAX) of character variables in SQL
date: '2016-11-08T11:27:00.003-08:00'
author: Allan Bowe
tags: 
modified_time: '2016-11-08T11:52:10.577-08:00'
blogger_id: tag:blogger.com,1999:blog-3488921339026456633.post-1299806733192584837
---

It is perfectly valid to use <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; ">min()</span> as a <a href="http://support.sas.com/kb/25/279.html" target="_blank">summary function</a> on character values in <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; ">proc sql</span>, eg as follows:<br /><blockquote class="tr_bq" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><b><span style="background: white; color: navy; font-family: &quot;courier new&quot;;">proc</span></b><span style="background: white; font-family: &quot;courier new&quot;;"> </span><b><span style="background: white; color: navy; font-family: &quot;courier new&quot;;">sql</span></b><span style="background: white; font-family: &quot;courier new&quot;;">;<br /><o:p></o:p></span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">create</span><span style="background: white; font-family: &quot;courier new&quot;;"> </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">table</span><span style="background: white; font-family: &quot;courier new&quot;;"> test </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">as</span><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; <br /><o:p></o:p></span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">&nbsp; select</span><span style="background: white; font-family: &quot;courier new&quot;;"> min(name) </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">as</span><span style="background: white; font-family: &quot;courier new&quot;;"> minval<br /><o:p></o:p></span><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">from</span><span style="background: white; font-family: &quot;courier new&quot;;"> sashelp.class;<o:p></o:p></span></blockquote><br /><br />This is not so, however, when using in an inline context:<br /><blockquote class="tr_bq" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><b><span style="background: white; color: navy; font-family: &quot;courier new&quot;;">proc</span></b><span style="background: white; font-family: &quot;courier new&quot;;"> </span><b><span style="background: white; color: navy; font-family: &quot;courier new&quot;;">sql</span></b><span style="background: white; font-family: &quot;courier new&quot;;">;<br /><o:p></o:p></span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">create</span><span style="background: white; font-family: &quot;courier new&quot;;"> </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">table</span><span style="background: white; font-family: &quot;courier new&quot;;"> test </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">as</span><span style="background: white; font-family: &quot;courier new&quot;;"><br /> <o:p></o:p></span><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">select</span><span style="background: white; font-family: &quot;courier new&quot;;"> min(name,sex) </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">as</span><span style="background: white; font-family: &quot;courier new&quot;;"> minval<br /><o:p></o:p></span><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">from</span><span style="background: white; font-family: &quot;courier new&quot;;"> sashelp.class;</span></blockquote><br />Which gives:<br /><blockquote class="tr_bq" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span style="background: white; color: red; font-family: &quot;courier new&quot;;">ERROR: Function MIN requires a numeric expression as argument 1.</span></div><div class="MsoNormal"><span style="background: white; color: red; font-family: &quot;courier new&quot;;">ERROR: Function MIN requires a numeric expression as argument 2.<o:p></o:p></span></div></blockquote><div class="MsoNormal"><o:p></o:p></div><br />So what are the alternatives? &nbsp;If we were in datastep, we might have had the option of the little-known<a href="http://support.sas.com/documentation/cdl/en/lrcon/62955/HTML/default/viewer.htm#a000780367.htm" target="_blank"> infix operator</a>&nbsp;for min (&gt;&lt;):<br /><blockquote class="tr_bq" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><b><span style="background: white; color: navy; font-family: &quot;courier new&quot;;">data</span></b><span style="background: white; font-family: &quot;courier new&quot;;"> </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">_null_</span><span style="background: white; font-family: &quot;courier new&quot;;">;<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; minval=</span><span style="background: white; color: purple; font-family: &quot;courier new&quot;;">'Less'</span><span style="background: white; font-family: &quot;courier new&quot;;">&gt;&lt;</span><span style="background: white; color: purple; font-family: &quot;courier new&quot;;">'More'</span><span style="background: white; font-family: &quot;courier new&quot;;">&gt;&lt;</span><span style="background: white; color: purple; font-family: &quot;courier new&quot;;">'Lots'</span><span style="background: white; font-family: &quot;courier new&quot;;">;<o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">put</span><span style="background: white; font-family: &quot;courier new&quot;;"> minval=;&nbsp; </span><span style="background: white; color: green; font-family: &quot;courier new&quot;;">/* minval=Less */</span><span style="background: white; font-family: &quot;courier new&quot;;"><o:p></o:p></span></div><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><b><span style="background: white; color: navy; font-family: &quot;courier new&quot;;">run</span></b><span style="background: white; font-family: &quot;courier new&quot;;">;</span><o:p></o:p></div></blockquote><br />As it happens though, the min &amp; max infix operators are not valid in proc sql. &nbsp;Another approach, if comparing just two values, would be&nbsp;<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">ifc()</span> - eg:<br /><blockquote class="tr_bq" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><b><span style="background: white; color: navy; font-family: &quot;courier new&quot;;">proc</span></b><span style="background: white; font-family: &quot;courier new&quot;;"> </span><b><span style="background: white; color: navy; font-family: &quot;courier new&quot;;">sql</span></b><span style="background: white; font-family: &quot;courier new&quot;;">;<br /><o:p></o:p></span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">create</span><span style="background: white; font-family: &quot;courier new&quot;;"> </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">table</span><span style="background: white; font-family: &quot;courier new&quot;;"> test </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">as<br /><o:p></o:p></span><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp;</span>&nbsp; <span style="background: white; color: blue; font-family: &quot;courier new&quot;;">select</span><span style="background: white; font-family: &quot;courier new&quot;;"> ifc(name&lt;sex,name,sex) </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">as</span><span style="background: white; font-family: &quot;courier new&quot;;"> minval<br /><o:p></o:p></span><span style="background: white; font-family: &quot;courier new&quot;;"><o:p></o:p></span><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">from</span><span style="background: white; font-family: &quot;courier new&quot;;"> sashelp.class;<o:p></o:p></span></blockquote><br /><br />But what if we have more than two values? &nbsp;In this instance, it becomes necessary to take matters into your own hands! &nbsp;I've gone ahead and rolled up an FCMP function below, which could surely be improved, but does the job when comparing three character values in either data step or proc sql:<br /><blockquote class="tr_bq" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><br /><b><span style="background: white; color: navy; font-family: &quot;courier new&quot;;">proc</span></b><span style="background: white; font-family: &quot;courier new&quot;;"> </span><b><span style="background: white; color: navy; font-family: &quot;courier new&quot;;">fcmp</span></b><span style="background: white; font-family: &quot;courier new&quot;;"> </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">outlib</span><span style="background: white; font-family: &quot;courier new&quot;;">=work.myfuncs.test;<br /><o:p></o:p></span><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">function</span><span style="background: white; font-family: &quot;courier new&quot;;"> minC(a $, b $, c $) $;<br /><o:p></o:p></span><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp;&nbsp;&nbsp; </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">length</span><span style="background: white; font-family: &quot;courier new&quot;;"> result $</span><b><span style="background: white; color: teal; font-family: &quot;courier new&quot;;">1000</span></b><span style="background: white; font-family: &quot;courier new&quot;;">;<br /><o:p></o:p></span><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp;&nbsp;&nbsp; result=a&gt;&lt;b&gt;&lt;c;</span><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp;&nbsp;&nbsp; <br /><o:p></o:p></span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">&nbsp; &nbsp; return</span><span style="background: white; font-family: &quot;courier new&quot;;"> (result);<br /><o:p></o:p></span><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">endsub</span><span style="background: white; font-family: &quot;courier new&quot;;">;<br /><o:p></o:p></span><b><span style="background: white; color: navy; font-family: &quot;courier new&quot;;">quit</span></b><span style="background: white; font-family: &quot;courier new&quot;;">;<br /><o:p></o:p></span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">options</span><span style="background: white; font-family: &quot;courier new&quot;;"> </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">cmplib</span><span style="background: white; font-family: &quot;courier new&quot;;">=work.myfuncs;<br /><o:p></o:p></span><b><span style="background: white; color: navy; font-family: &quot;courier new&quot;;">data</span></b><span style="background: white; font-family: &quot;courier new&quot;;"> </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">_null_</span><span style="background: white; font-family: &quot;courier new&quot;;">;<br /><o:p></o:p></span><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">x</span><span style="background: white; font-family: &quot;courier new&quot;;">=</span><span style="background: white; color: purple; font-family: &quot;courier new&quot;;">'Killing'</span><span style="background: white; font-family: &quot;courier new&quot;;">;<br /><o:p></o:p></span><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; y=</span><span style="background: white; color: purple; font-family: &quot;courier new&quot;;">'Me'</span><span style="background: white; font-family: &quot;courier new&quot;;">;<br /><o:p></o:p></span><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; z=</span><span style="background: white; color: purple; font-family: &quot;courier new&quot;;">'Softly'</span><span style="background: white; font-family: &quot;courier new&quot;;">;<br /><o:p></o:p></span><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; outvar=minC(x,y,z);</span><span style="background: white; font-family: &quot;courier new&quot;;"><br /><o:p></o:p></span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">&nbsp; put</span><span style="background: white; font-family: &quot;courier new&quot;;"> outvar=;<br /><o:p></o:p></span><b><span style="background: white; color: navy; font-family: &quot;courier new&quot;;">run</span></b><span style="background: white; font-family: &quot;courier new&quot;;">;<br /><o:p></o:p></span><b><span style="background: white; color: navy; font-family: &quot;courier new&quot;;">proc</span></b><span style="background: white; font-family: &quot;courier new&quot;;"> </span><b><span style="background: white; color: navy; font-family: &quot;courier new&quot;;">sql</span></b><span style="background: white; font-family: &quot;courier new&quot;;">;<br /><o:p></o:p></span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">create</span><span style="background: white; font-family: &quot;courier new&quot;;"> </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">table</span><span style="background: white; font-family: &quot;courier new&quot;;"> test </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">as</span><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; <br /><o:p></o:p></span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">&nbsp; select</span><span style="background: white; font-family: &quot;courier new&quot;;"> minC(name,sex)<br /><o:p></o:p></span><span style="background: white; font-family: &quot;courier new&quot;;">&nbsp; </span><span style="background: white; color: blue; font-family: &quot;courier new&quot;;">from</span><span style="background: white; font-family: &quot;courier new&quot;;"> sashelp.class;</span></blockquote><div class="MsoNormal" style="line-height: normal; margin-bottom: .0001pt; margin-bottom: 0cm; mso-layout-grid-align: none; text-autospace: none;"><o:p></o:p></div><br /><div class="MsoNormal"><br /></div>Would you deal with the requirement any differently? &nbsp;Let me know in the comments!<br /><br />